{% extends 'layout.html' %}

{% block content %}
<div id="sspi-root" class="customizable-sspi"></div>

<script>
// Backend data - csrf.js utility automatically uses window.csrfToken
window.csrfToken = {{ csrf_token|tojson|safe }};
window.sspiUsername = {{ current_user.username|tojson|safe }};
window.sspiActiveSession = {{ active_session|tojson|safe if active_session else 'null' }};

// Initialize customization builder
document.addEventListener('DOMContentLoaded', () => {
    const root = document.getElementById('sspi-root');
    window.SSPICharts.push(
        new CustomizableSSPIStructure(root, {
            username: window.sspiUsername,
            activeSession: window.sspiActiveSession
        })
    );
    window.customSSPI = window.SSPICharts[0];
});
</script>
{% endblock %}
